<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Excel → Sheets Add-in</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="./taskpane.css" />
  <link rel="icon" href="https://outsider1113.github.io/excel_to_sheets_addon/assets/favicon.ico" type="image/x-icon" />
  <link rel="shortcut icon" href="https://outsider1113.github.io/excel_to_sheets_addon/assets/favicon.ico" type="image/x-icon" />



</head>
<body>
  <div id="app">

    <!-- SIGN IN PANEL -->
    <div id="auth-section" class="panel">
      <button id="googleSignInBtn">Sign in with Google</button>
      <button id="verifyAuthBtn" style="margin-top:10px;">Verify Sign-In</button>
      <p id="authStatus" class="status-text"></p>
    </div>

    <!-- status box for general UI messages (replace alerts) -->
    <div id="statusBox" class="info-box hidden" role="status" aria-live="polite"></div>

    <!-- MAIN CONTENT (hidden until authenticated) -->
    <div id="mainContent" class="hidden">

      <!-- CHOOSE SHEETS FILE (required first) -->
      <div id="chooseSheetPanel" class="panel">
        <h3>Select Google Sheets file (required)</h3>
        <button id="reloadSheetsBtn" class="secondary-btn" style="margin-bottom:8px;">Reload Sheets List</button>
        <select id="modify_sheet_select" style="width:100%;"></select>
      </div>

      <!-- ACTIVE WORKSHEET STATUS -->
      <div id="activeSheetBox" class="info-box">
        <div><strong>Active Excel Worksheet:</strong> <span id="activeSheetName">—</span></div>
        <div id="sheetChangeWarning" class="warning hidden">
          Active worksheet changed. Click <button id="refreshActiveSheet" class="secondary-btn small-btn">Refresh</button> to re-sync.
        </div>
      </div>


      <div id="modeBanner" class="mode-banner hidden">
        <span class="label">Mode</span>
        <span class="text">Waiting for Excel tab...</span>
      </div>

      <!-- MODE SELECTOR -->
      <div id="createPanel" class="panel">
        <h3>Send Active Excel Tab To Google Sheets</h3>
        <div id="createFormatWarning" class="warning hidden"></div>
        <div id="createExistsWarning" class="warning hidden"></div>

        <label>Workspace Name (auto-detected from active Excel tab):</label>
        <input id="create_workspace_name" placeholder="Active worksheet name" />

        <div style="margin-top:8px;">
          <button id="create_prefill" class="secondary-btn">Read Data From Excel</button>
        </div>

        <h4>Header Fields (read from Excel)</h4>
        <div class="field-grid">
          <label>PURCHASE FROM:</label><input id="c_pf" />
          <label>DATE RECEIVED:</label><input id="c_dr" />
          <label>CARRIER:</label><input id="c_carrier" />
          <label>OUR PO#:</label><input id="c_po" />
          <label>RECEIVER#:</label><input id="c_rcv" />
          <label>VERIFIED BY:</label><input id="c_ver" />
        </div>

        <h4 style="margin-top:10px;">Line Items (multiple rows)</h4>
        <div class="line-items-header">
          <span>ITEM NO</span>
          <span>COMMODITY</span>
          <span>GROSS</span>
          <span>TARE</span>
          <span>NET</span>
          <span>COST</span>
          <span></span>
        </div>
        <div id="createLineItemsContainer" class="line-items-container"></div>
        <button id="create_add_line" type="button" class="secondary-btn small-btn" style="margin-top:6px;">+ Add Line</button>

        <div class="totals-bar" aria-label="Receiver totals">
          <div class="totals-box">
            <div class="totals-label">Net Total $</div>
            <input id="create_net_total" class="totals-input" value="" readonly />
          </div>
        </div>

        <div class="row actions">
          <button id="create_send" class="primary-btn disabled" disabled>Review & Send to Sheets</button>
        </div>
      </div>

    </div>
  </div>

  <div id="actionModal" class="modal hidden" role="dialog" aria-modal="true">
    <div class="modal-card">
      <h3 id="actionModalTitle">Review action</h3>
      <p id="actionModalBody"></p>
      <div class="modal-actions">
        <button id="actionModalCancel" class="secondary-btn" type="button">Cancel</button>
        <button id="actionModalConfirm" class="primary-btn" type="button">Continue</button>
      </div>
    </div>
  </div>

  <div id="globalLoadingOverlay" class="hidden">
    <div class="global-loading-card">
      <div class="spinner"></div>
      <div id="globalLoadingText" class="global-loading-text">Working with Google Sheets...</div>
    </div>
  </div>

  <!-- Office.js must be loaded before taskpane.js -->
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <script src="taskpane.core.js"></script>
  <script src="taskpane.workflow.js"></script>
  <script src="taskpane.js"></script>
</body>
</html>
